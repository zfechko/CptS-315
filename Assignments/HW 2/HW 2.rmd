---
title: CptS 315 - HW 2
author: Zach Fechko (011711215)
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: html_document
---
***


# Q1
Consider the following ratings matrix with 3 users and 6 items. Ratings are on a 1-5 star scale. Compute the following from this matrix:  

| | Item 1 | Item 2 | Item 3 | Item 4 | Item 5 | Item 6 |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| **User 1** | 4 | 5 |   | 5 | 1 |   |
| **User 2** |   | 3 | 4 | 3 | 1 | 2 | 
| **User 3** | 2 |   | 1 | 3 |   | 4 |

a. Treat missing values as 0. Compute the jaccard similarity between each pair of users 
b. Treat missing values as 0. Compute the cosine similarity between each pair of users
c. Normalize the matrix by subtracting from each non-zero rating, the average value for its user. Show the normalized matrix. 
d. Compute the (centered) cosine similarity between each pair of users using the normalized matrix.

## Q1 Solution
### a. 
$J(A, B) = \frac{|A \cap B|}{|A \cup B|}$  

```{python pychunk, results='hold'}
import pandas as pd 
import numpy as np

# Read in the data
ratings = pd.read_csv('ratings.csv').set_index('User')
print(ratings)

def jaccard(a, b):
    """
    Calculates the Jaccard similarity between two lists.
    """
    a = set(a)
    b = set(b)
    c = a.intersection(b)
    return float(len(c)) / (len(a) + len(b) - len(c))

print("Users 1 & 2: ", jaccard(list(ratings.loc["User 1"]), list(ratings.loc["User 2"]))) #jaccard similarity between user 1 and 2
print("Users 1 & 3: ", jaccard(list(ratings.loc["User 1"]), list(ratings.loc["User 3"]))) #jaccard similarity between user 1 and 3
print("Users 2 & 3: ", jaccard(list(ratings.loc["User 2"]), list(ratings.loc["User 3"]))) #jaccard similarity between user 2 and 3
```

### b. 
$C(A, B) = \frac{A \cdot B}{\|A\| \|B\|}$  
```{python pychunk1, results='hold'}
from numpy.linalg import norm

def cosine(a: list, b: list):
    """
    Calculates the cosine similarity between two lists
    """
    A = np.array(a)
    B = np.array(b)
    return np.dot(A, B) / (norm(A) * norm(B))

print("Users 1 & 2: ", cosine(list(ratings.loc["User 1"]), list(ratings.loc["User 2"]))) #cosine similarity between user 1 and 2
print("Users 1 & 3: ", cosine(list(ratings.loc["User 1"]), list(ratings.loc["User 3"]))) #cosine similarity between user 1 and 3
print("Users 2 & 3: ", cosine(list(ratings.loc["User 2"]), list(ratings.loc["User 3"]))) #cosine similarity between user 2 and 3
```

### c. 
```{python pychunk3, results='hold'}
# Normalize the matrix by subtracting from each non-zero rating, the average value for its user. Show the normalized matrix.
def normalize_matrix(matrix: pd.DataFrame):
    """
    Normalizes a matrix by subtracting the mean from each value.
    """
    return matrix.sub(matrix.mean(axis=1), axis=0) #subtracts each value by the mean of the row

norm_ratings = normalize_matrix(ratings)
print(norm_ratings)
```

### d. 
Using the `norm_ratings` df from part c and the `cosine` function from part b, we can calculate the cosine similarity between each pair of users.  
```{python pychunk4, results='hold'}
# Compute the (centered) cosine similarity between each pair of users using the normalized matrix.
print("Users 1 & 2: ", cosine(list(norm_ratings.loc["User 1"]), list(norm_ratings.loc["User 2"]))) #cosine similarity between user 1 and 2
print("Users 1 & 3: ", cosine(list(norm_ratings.loc["User 1"]), list(norm_ratings.loc["User 3"]))) #cosine similarity between user 1 and 3
print("Users 2 & 3: ", cosine(list(norm_ratings.loc["User 2"]), list(norm_ratings.loc["User 3"]))) #cosine similarity between user 2 and 3
```

# Q2
Read the following two papers and write a brief summary of the main points in at most **TWO** pages.  
[Two Decades of Recommender Systems at Amazon.com](https://www.computer.org/csdl/mags/ic/2017/03/mic2017030012.pdf)  
[Industry Report: Amazon.com Recommendations: Item-to-Item](https://www.cs.umd.edu/~samir/498/Amazon-Recommendations.pdf)

\pagebreak

## Q2 Solution